{% extends "base.twig" %}

{% block content %}

<div class="container">

    <section class="section">

        <div class="section-title"><h1>Recorded VODs</h1></div>

        <div class="section-content">

            <a class="button" href="?checkvod=1">Check if VODs exist</a>
            {% if checkvod %}
                {% if is_a_vod_deleted %}
                    - <strong>A VOD IS DELETED</strong>
                {% else %}
                    - all vods seem to still exist
                {% endif %}
            {% endif %}
            
            <br><br>

            {% for streamer in streamerList %}

                <div class="streamer">

                    <div id="streamer_{{ streamer.username }}" class="anchor"></div>

                    <div class="streamer-title">
                        <h2>
                            <a href="https://twitch.tv/{{ streamer.username }}" rel="noreferrer" target="_blank">
                                {{ streamer.username }}
                            </a>
                            {% if streamer.is_live %}
                                 <span class="live">live</span>
                            {% endif %}
                        </h2>
                        <span class="small">
                            {{ streamer.quality }}
                             &middot; 
                            {{ streamer.vods_list|length }} vods
                             &middot; 
                            {{ streamer.vods_size|formatBytes }}
                             &middot;
                             <a href="{{ url_for('force_record', { 'username': streamer.username }) }}">record</a>
                        </span>
                    </div>

                    {% if streamer.vods_list|length == 0 %}

                        <div class="notice">None</div>

                    {% else %}
                        
                        {% for vodclass in streamer.vods_list %}

                            {% include 'components/vod.twig' %}

                        {% endfor %}

                    {% endif %}

                </div>

            {% endfor %}

            <div>
                <strong>Total size: {{ total_size|formatBytes }}</strong><br>
                <strong>Free size: {{ free_size|formatBytes }}</strong>
            </div>

        </div>

    </section>


    <section class="section" style="display: none;">

        <div class="section-title"><h1>Hook</h1></div>

        <div class="section-content">
        
        <form method="post" action="hook.php">
            <textarea class="input" name="json"></textarea>
            <br><button class="button" type="submit">Hook</button>
        </form>

        </div>

    </section>

    {# logs #}
    <section class="section">

        <div class="section-title"><h1>Logs</h1></div>

        <div class="section-content">

            <div class="log_viewer">
                
                {% for line in log_lines %}

                    <div class="log_{{ line.level|lower }}">{{ line.date_string }} &lt;{{ line.level }}&gt; {{ line.text }}</div>

                {% endfor %}

            </div>

        </div>

    </section>

</div>

{% endblock %}
